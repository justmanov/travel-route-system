<!DOCTYPE html>
<html lang="uk">
    <head>
        <meta charset="UTF-8">
        <title>–í–∞—à –º–∞—Ä—à—Ä—É—Ç</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
        <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    </head>
    <body>
    <div class="container">
        <h1 class="main-title">–í–∞—à –º–∞—Ä—à—Ä—É—Ç</h1>
    
        <div id="map" style="height: 400px; border-radius: 10px; overflow: hidden;"></div>
    
        <div class="route-stats-card">
            <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–∞—Ä—à—Ä—É—Ç—É</h2>
            <ul class="route-stats-list">
                <li><strong>–í—ñ–¥—Å—Ç–∞–Ω—å:</strong> {{ distance }} –∫–º</li>
                <li><strong>–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å:</strong> {{ duration }} —Ö–≤</li>
                <li><strong>–í–∏—Ç—Ä–∞—Ç–∞ –ø–∞–ª—å–Ω–æ–≥–æ:</strong> {{ fuel }} –ª</li>
                <li><strong>–ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–∞–º º—è—Ç–æ–∫:</strong> {{ poi_count }}</li>
            </ul>
        </div>
        
    
        <div class="steps-box">
            <h2>–û–ø–∏—Å –º–∞—Ä—à—Ä—É—Ç—É</h2>
            <div class="route-steps">
                {% for step in steps %}
                  <div class="step-box">
                    <span class="step-num">{{ loop.index }}.</span>
                    <span class="step-text">{{ step }}</span>
                  </div>
                {% endfor %}
              </div>
              
        </div>
        
        <div class="button-wrapper">
            <form action="/" method="get" style="text-align: center;">
                <button type="submit">–ù–æ–≤–∏–π –º–∞—Ä—à—Ä—É—Ç</button>
            </form>
            
        </div>
        
    </div> 

    <script>
        const route = JSON.parse(`{{ geojson|tojson|safe }}`);
    
        const map = L.map('map').setView([50.45, 30.52], 10);
    
        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);
    
        const geoLayer = L.geoJSON(route).addTo(map);
        map.fitBounds(geoLayer.getBounds());
        // –î–æ–¥–∞–≤–∞–Ω–Ω—è –º–∞—Ä–∫–µ—Ä—ñ–≤ POI –Ω–∞ –∫–∞—Ä—Ç—É (–æ–ø—Ü—ñ–π–Ω–æ)
        {% if pois %}
        const pois = {{ pois | tojson | safe }};
        pois.forEach(function(poi) {
            var marker = L.marker([poi.lat, poi.lon]).addTo(map);
            marker.bindPopup("<strong>" + poi.name + "</strong><br>" + poi.lat.toFixed(5) + ", " + poi.lon.toFixed(5));
        });
        {% endif %}
    </script>
    
</body>
</html>
